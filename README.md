# ì—°êµ¬ì‹¤ ê²€ìƒ‰ ì‹œìŠ¤í…œ v2.0 (ê³ ê¸‰ ê¸°ëŠ¥ í¬í•¨)

ì¸í•˜ëŒ€í•™êµ ì „ê¸°ì»´í“¨í„°ê³µí•™ê³¼ ì—°êµ¬ì‹¤ ì •ë³´ë¥¼ í¬ë¡¤ë§í•˜ê³ , ì„ë² ë”©í•˜ì—¬ ë²¡í„° ê²€ìƒ‰ì„ ì§€ì›í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

## âœ¨ v2.0 ì£¼ìš” ì—…ë°ì´íŠ¸

### ğŸ›¡ï¸ í’ˆì§ˆ ê´€ë¦¬ & ê°€ë“œë ˆì¼
- **í’ˆì§ˆ ì ìˆ˜ ìë™ ê³„ì‚°** (0.0-1.0): ì„¹ì…˜ ì¼ì¹˜ë„, ê¸¸ì´, ì–¸ì–´ ì¼ê´€ì„±, ì¤‘ë³µ ì—¬ë¶€
- **PII ê°ì§€**: ê°œì¸ì •ë³´/ë¡œê·¸ì¸ í˜ì´ì§€ ìë™ ì°¨ë‹¨
- **ê²€ìˆ˜ ëŒ€ìƒ ìë™ í‘œì‹œ**: í’ˆì§ˆ ì ìˆ˜ 0.5 ë¯¸ë§Œ ë¬¸ì„œ

### ğŸš€ í¬ë¡¤ë§ ë§¤ë‹ˆì €
- **robots.txt ì¤€ìˆ˜**: ë²•ì  ë¬¸ì œ ì˜ˆë°©
- **ì†ë„ ì œì–´**: 0.5-1.0 req/sec (ì„œë²„ ë¶€ë‹´ ìµœì†Œí™”)
- **ì§€ìˆ˜ ë°±ì˜¤í”„ ì¬ì‹œë„**: ì¼ì‹œì  ì˜¤ë¥˜ ìë™ ë³µêµ¬
- **HTTP ìºì‹±**: ETag/Last-Modified ì§€ì›

### ğŸ“Š ì—…ë°ì´íŠ¸ ì „ëµ
- **ì¬í¬ë¡¤ ì£¼ê¸° ê´€ë¦¬**: 2-4ì£¼ ìë™ ì¬í¬ë¡¤
- **ì†Œí”„íŠ¸ ì‚­ì œ**: íˆìŠ¤í† ë¦¬ ë³´ì¡´
- **ê°ì‚¬ ë¡œê·¸**: ëª¨ë“  í¬ë¡¤ë§ ìš”ì²­ ê¸°ë¡
- **ë³€ê²½ ì´ë ¥ ì¶”ì **: ì¶”ê°€/ìˆ˜ì •/ì‚­ì œ ê¸°ë¡

### ğŸ“„ ê³ ê¸‰ ì¶”ì¶œê¸°
- **PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ**: PyPDF2/pdfplumber ì§€ì›
- **í‘œ êµ¬ì¡° ë³´ì¡´**: venue/year ìë™ ë§¤í•‘, lab_tag ìƒì„±
- **ì´ë¯¸ì§€ OCR** (ì„ íƒ): pytesseract ì§€ì›

### ğŸ” ê²€ìƒ‰/ì¶”ì²œ ë©”íƒ€ë°ì´í„°
- **Signals**: ë…¼ë¬¸ ìˆ˜, ìˆ˜ìƒ ì´ë ¥, ì¥ë¹„ ì •ë³´ (ì¬ë­í‚¹ìš©)
- **Constraints**: ìµœì†Œ ì‹œê°„, ì£¼ë§ ê°€ëŠ¥, ëª¨ì§‘ ìœ í˜•
- **Provenance**: ì¶”ì²œ ì´ìœ  í‘œì‹œìš© ìŠ¤ë‹ˆí« ìºì‹œ

## ğŸ¯ ì´ ì‹œìŠ¤í…œì´ í•˜ëŠ” ì¼

**ê°„ë‹¨ ìš”ì•½:**
1. ì—°êµ¬ì‹¤ ì›¹ì‚¬ì´íŠ¸ì—ì„œ í…ìŠ¤íŠ¸ ìˆ˜ì§‘ (í¬ë¡¤ë§)
2. í…ìŠ¤íŠ¸ë¥¼ ìˆ«ì ë²¡í„°ë¡œ ë³€í™˜ (ì„ë² ë”©)
3. ê²€ìƒ‰ì–´ì™€ ìœ ì‚¬í•œ ë¬¸ì„œ ì°¾ê¸° (ë²¡í„° ê²€ìƒ‰)

**ìì„¸í•œ ì„¤ëª…:**
- ì—°êµ¬ì‹¤ í™ˆí˜ì´ì§€ë¥¼ ìë™ìœ¼ë¡œ ë°©ë¬¸í•´ì„œ ë‚´ìš©ì„ ìˆ˜ì§‘í•©ë‹ˆë‹¤
- ìˆ˜ì§‘í•œ í…ìŠ¤íŠ¸ë¥¼ AI ëª¨ë¸ë¡œ "ì˜ë¯¸"ë¥¼ ì´í•´í•  ìˆ˜ ìˆëŠ” ìˆ«ìë¡œ ë³€í™˜í•©ë‹ˆë‹¤
- "ì»´í“¨í„° ë¹„ì „"ìœ¼ë¡œ ê²€ìƒ‰í•˜ë©´ ê´€ë ¨ ì—°êµ¬ì‹¤ì„ ìë™ìœ¼ë¡œ ì°¾ì•„ì¤ë‹ˆë‹¤
- ë‹¨ìˆœ í‚¤ì›Œë“œ ë§¤ì¹­ì´ ì•„ë‹ˆë¼ ì˜ë¯¸ë¥¼ ì´í•´í•˜ëŠ” ê²€ìƒ‰ì…ë‹ˆë‹¤

## ğŸ“ íŒŒì¼ êµ¬ì¡° ì„¤ëª…

### í•µì‹¬ íŒŒì´í”„ë¼ì¸
```
íŒŒì¼ ì´ë¦„              ì—­í• 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
chunking.py          â†’ ì›¹í˜ì´ì§€ì—ì„œ ë³¸ë¬¸ ì¶”ì¶œ, ì ì ˆí•œ í¬ê¸°ë¡œ ë¶„í• 
text_normalization.py â†’ í…ìŠ¤íŠ¸ ì •ë¦¬ (ì–¸ì–´ ê°ì§€, ì—°ë½ì²˜ ì¶”ì¶œ)
embedding.py         â†’ í…ìŠ¤íŠ¸ë¥¼ ìˆ«ì ë²¡í„°ë¡œ ë³€í™˜ (768ê°œ ìˆ«ì)
local_storage.py     â†’ JSON íŒŒì¼ë¡œ ì €ì¥/ê²€ìƒ‰ (DB ë¶ˆí•„ìš”)
vector_db.py         â†’ PostgreSQLë¡œ ì €ì¥/ê²€ìƒ‰ (ëŒ€ìš©ëŸ‰ìš©)
main_pipeline.py     â†’ ìœ„ ëª¨ë“ˆë“¤ì„ í†µí•©í•˜ì—¬ ì‹¤í–‰
search_local.py      â†’ ë¡œì»¬ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ ë„êµ¬
```

### ğŸ†• ê³ ê¸‰ ê¸°ëŠ¥ (v2.0)
```
íŒŒì¼ ì´ë¦„              ì—­í• 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
quality_guard.py     â†’ í’ˆì§ˆ ì ìˆ˜ ê³„ì‚°, PII ê°ì§€, URL ì°¨ë‹¨
crawl_manager.py     â†’ ì†ë„ ì œì–´, ì¬ì‹œë„, robots.txt, ìºì‹±
advanced_extractors.py â†’ PDF, í‘œ, ì´ë¯¸ì§€ OCR ì²˜ë¦¬
schema_enhanced.sql  â†’ í–¥ìƒëœ DB ìŠ¤í‚¤ë§ˆ (í’ˆì§ˆ, ê°ì‚¬, ë©”íƒ€ë°ì´í„°)
test_advanced_features.py â†’ ê³ ê¸‰ ê¸°ëŠ¥ ì¢…í•© í…ŒìŠ¤íŠ¸
ADVANCED_FEATURES.md â†’ ê³ ê¸‰ ê¸°ëŠ¥ ìƒì„¸ ë¬¸ì„œ
```

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### ê¸°ë³¸ ì„¤ì¹˜
```bash
# ê°€ìƒí™˜ê²½ ìƒì„±
python -m venv venv
.\venv\Scripts\activate  # Windows

# ê¸°ë³¸ íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install -r requirements.txt
```

### ê³ ê¸‰ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
```bash
# í’ˆì§ˆ ì ìˆ˜, PII ê°ì§€, í¬ë¡¤ë§ ë§¤ë‹ˆì €, í‘œ ì¶”ì¶œ í…ŒìŠ¤íŠ¸
python test_advanced_features.py
```

## ğŸ“š ìƒì„¸ ë¬¸ì„œ

- **[ADVANCED_FEATURES.md](ADVANCED_FEATURES.md)** - ê³ ê¸‰ ê¸°ëŠ¥ ìƒì„¸ ê°€ì´ë“œ
  - í’ˆì§ˆ ì ìˆ˜ ê³„ì‚° ë°©ë²•
  - ê°€ë“œë ˆì¼ ì„¤ì •
  - í¬ë¡¤ë§ ë§¤ë‹ˆì € ì‚¬ìš©ë²•
  - PDF/í‘œ ì¶”ì¶œ
  - ê²€ìƒ‰ ë©”íƒ€ë°ì´í„° í™œìš©

- **[ì½”ë“œì„¤ëª….md](ì½”ë“œì„¤ëª….md)** - ì´ˆë³´ììš© ì½”ë“œ ì„¤ëª… (í•œê¸€)

## ğŸ”§ ì‹œìŠ¤í…œ êµ¬ì„±

### 1. ì²­í‚¹ & ë³¸ë¬¸ ì¶”ì¶œ (`chunking.py`)
- **ì²­í‚¹ ê·œì¹™**: ë¬¸ë‹¨ ê¸°ì¤€ 200-400ì (150-300í† í°)
- **ë³¸ë¬¸ ì¶”ì¶œ**: Readability ê³„ì—´ ë°©ì‹ìœ¼ë¡œ ë„¤ë¹„/í‘¸í„°/ì‚¬ì´ë“œë°” ì œê±°
- **ì„¹ì…˜ ë¶„ë¥˜**: about, research, publication, project, join, people
- **ì¤‘ë³µ ê°ì§€**: MD5 í•´ì‹œë¡œ ë™ì¼ ì²­í¬ ì¬ì²˜ë¦¬ ë°©ì§€

### 2. í…ìŠ¤íŠ¸ ì •ê·œí™” (`text_normalization.py`)
- **ì–¸ì–´ ê°ì§€**: ko (í•œê¸€), en (ì˜ë¬¸), mixed (í˜¼í•©)
- **í´ë¦°ì—…**: ê³µë°±, ì €ì‘ê¶Œ ë¸”ë¡, ë‚´ë¹„ê²Œì´ì…˜ í…ìŠ¤íŠ¸ ì œê±°
- **ì—°ë½ì²˜ ì¶”ì¶œ**: URL, ì´ë©”ì¼, ì „í™”ë²ˆí˜¸ ë³„ë„ ë©”íƒ€ë°ì´í„°ë¡œ ë¶„ë¦¬
- **í† í° ê³„ì‚°**: í•œê¸€/ì˜ë¬¸ í˜¼í•© í…ìŠ¤íŠ¸ í† í° ìˆ˜ ì¶”ì •

### 3. ì„ë² ë”© ìƒì„± (`embedding.py`)
- **ëª¨ë¸**: ë©€í‹°ë§ê¶ ì§€ì›
  - `multilingual-mpnet` (ê¸°ë³¸, 768ì°¨ì›)
  - `multilingual-e5-large` (1024ì°¨ì›)
  - `ko-sbert-multitask` (í•œêµ­ì–´ íŠ¹í™”)
- **ì •ê·œí™”**: L2 ì •ê·œí™”ë¡œ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ìµœì í™”
- **ìºì‹±**: ì¤‘ë³µ ì„ë² ë”© ê³„ì‚° ë°©ì§€
- **ë°°ì¹˜ ì²˜ë¦¬**: íš¨ìœ¨ì ì¸ ëŒ€ëŸ‰ ì²˜ë¦¬

### 4. ë²¡í„° DB (`vector_db.py`)
- **PostgreSQL + pgvector**: ë²¡í„° ê²€ìƒ‰ ì§€ì›
- **HNSW ì¸ë±ìŠ¤**: 
  - M=32 (ì—°ê²° ìˆ˜)
  - ef_construction=128 (ì¸ë±ìŠ¤ ë¹Œë“œ í’ˆì§ˆ)
  - ef_search=64 (ê²€ìƒ‰ í’ˆì§ˆ)
- **í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰**: ë²¡í„°(70%) + í‚¤ì›Œë“œ(30%) ê°€ì¤‘í•©
- **ì¤‘ë³µ ë°©ì§€**: MD5 í•´ì‹œë¡œ ë™ì¼ ë¬¸ì„œ ìŠ¤í‚µ

### 5. í†µí•© íŒŒì´í”„ë¼ì¸ (`main_pipeline.py`)
- ì „ì²´ í”„ë¡œì„¸ìŠ¤ ìë™í™”
- í¬ë¡¤ë§ â†’ ì²­í‚¹ â†’ ì •ê·œí™” â†’ ì„ë² ë”© â†’ DB ì €ì¥
- ì§„í–‰ ìƒí™© ì‹¤ì‹œê°„ ì¶œë ¥
- ì˜¤ë¥˜ ì²˜ë¦¬ ë° ì¬ì‹œë„

## ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### í•µì‹¬ í…Œì´ë¸”

#### `lab` - ì—°êµ¬ì‹¤ ê¸°ë³¸ ì •ë³´
```sql
- lab_id (PK)
- kor_name, eng_name
- professor
- homepage, location
- contact_email, contact_phone
- quality_score
- last_crawled
```

#### `lab_docs` - ë¬¸ì„œ ì²­í¬ (ë²¡í„° ê²€ìƒ‰)
```sql
- doc_id (PK)
- lab_id (FK)
- section (about|research|publication|project|join|people)
- title, text
- lang (ko|en|mixed)
- tokens
- source_url, crawl_depth
- md5 (ì¤‘ë³µ ê°ì§€)
- embedding (vector(768)) â† pgvector
- emb_model, emb_ver
- quality_score
- text_tsv (í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ìš© tsvector)
```

#### `lab_tag` - ì—°êµ¬ì‹¤ íƒœê·¸
```sql
- lab_id (FK)
- tag_type (topic|method|equipment|venue|keyword)
- value
- confidence
- source (extraction|manual|llm)
```

#### `lab_link` - ì—°êµ¬ì‹¤ ë§í¬
```sql
- lab_id (FK)
- kind (research|publication|people|join)
- url, title
```

## ì„¤ì¹˜ ë°©ë²•

### 1. Python í™˜ê²½
```bash
# ê°€ìƒí™˜ê²½ ìƒì„±
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install -r requirements.txt
```

### 2. PostgreSQL + pgvector ì„¤ì¹˜

#### Ubuntu/Debian
```bash
# PostgreSQL 14+ ì„¤ì¹˜
sudo apt install postgresql postgresql-contrib

# pgvector ì„¤ì¹˜
sudo apt install postgresql-14-pgvector
```

#### macOS
```bash
brew install postgresql@14
brew install pgvector
```

#### Docker
```bash
docker run -d \
  --name labsearch-db \
  -e POSTGRES_PASSWORD=postgres \
  -e POSTGRES_DB=labsearch \
  -p 5432:5432 \
  ankane/pgvector
```

### 3. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
```bash
# PostgreSQL ì ‘ì†
psql -U postgres

# ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
CREATE DATABASE labsearch;
\c labsearch

# ìŠ¤í‚¤ë§ˆ ìƒì„±
\i schema.sql
```

## ì‚¬ìš© ë°©ë²•

### 1. ê¸°ë³¸ í¬ë¡¤ë§
```python
from main_pipeline import CrawlOrchestrator, DatabaseConfig

# DB ì„¤ì •
db_config = DatabaseConfig(
    host='localhost',
    port=5432,
    database='labsearch',
    user='postgres',
    password='your_password'
)

# ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° ì´ˆê¸°í™”
orchestrator = CrawlOrchestrator(
    db_config=db_config,
    embedding_model='multilingual-mpnet',
    device='cpu'  # ë˜ëŠ” 'cuda'
)

# í¬ë¡¤ë§ ì‹¤í–‰
url = "https://inhaece.co.kr/page/labs05"
df_result = orchestrator.crawl_from_url(url)

# ê²°ê³¼ ì €ì¥
df_result.to_csv('results.csv', index=False, encoding='utf-8-sig')
```

### 2. ë²¡í„° ê²€ìƒ‰
```python
from vector_db import VectorDatabase, DatabaseConfig
from embedding import EmbeddingPipeline

# DB ì—°ê²°
db_config = DatabaseConfig(...)
db = VectorDatabase(db_config)

# ì„ë² ë”© íŒŒì´í”„ë¼ì¸
pipeline = EmbeddingPipeline(model_name='multilingual-mpnet')

# ì¿¼ë¦¬ ì„ë² ë”©
query = "ë”¥ëŸ¬ë‹ê³¼ ì»´í“¨í„° ë¹„ì „ ì—°êµ¬"
query_emb = pipeline.embed(query)

# ë²¡í„° ê²€ìƒ‰
results = db.search_vector(
    query_embedding=query_emb.embedding,
    limit=10,
    min_quality=50
)

for r in results:
    print(f"[{r.lab_name}] {r.title}")
    print(f"  ì ìˆ˜: {r.score:.3f}")
    print(f"  í…ìŠ¤íŠ¸: {r.text[:100]}...")
    print()
```

### 3. í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰
```python
# ë²¡í„° + í‚¤ì›Œë“œ ê²€ìƒ‰
results = db.search_hybrid(
    query_text="ì»´í“¨í„° ë¹„ì „",
    query_embedding=query_emb.embedding,
    limit=10,
    vector_weight=0.7,
    keyword_weight=0.3
)

for r in results:
    print(f"{r.lab_name}: hybrid={r.score:.3f} (v={r.vector_score:.3f}, k={r.keyword_score:.3f})")
```

## ì„±ëŠ¥ ìµœì í™”

### 1. ì„ë² ë”© ëª¨ë¸ ì„ íƒ
```python
# ë¹ ë¥¸ ì²˜ë¦¬ (768ì°¨ì›)
model='multilingual-mpnet'

# ê³ í’ˆì§ˆ (1024ì°¨ì›, ëŠë¦¼)
model='multilingual-e5-large'

# í•œêµ­ì–´ íŠ¹í™” (768ì°¨ì›)
model='ko-sbert-multitask'
```

### 2. HNSW ì¸ë±ìŠ¤ íŠœë‹
```sql
-- ë” ì •í™•í•œ ê²€ìƒ‰ (ëŠë¦¼)
CREATE INDEX idx_docs_embedding ON lab_docs 
USING hnsw (embedding vector_cosine_ops)
WITH (m = 64, ef_construction = 256);

-- ë” ë¹ ë¥¸ ê²€ìƒ‰ (ì •í™•ë„ ë‚®ìŒ)
CREATE INDEX idx_docs_embedding ON lab_docs 
USING hnsw (embedding vector_cosine_ops)
WITH (m = 16, ef_construction = 64);

-- ê²€ìƒ‰ ì‹œ ì •í™•ë„ ì¡°ì •
SET hnsw.ef_search = 128;  -- ê¸°ë³¸ê°’ 64
```

### 3. ë°°ì¹˜ ì²˜ë¦¬
```python
# ëŒ€ëŸ‰ ì„ë² ë”©
results = pipeline.embed(
    texts=text_list,
    batch_size=64,  # GPU ë©”ëª¨ë¦¬ì— ë”°ë¼ ì¡°ì •
    use_cache=True
)
```

## í’ˆì§ˆ ê´€ë¦¬

### ì²­í¬ í’ˆì§ˆ ì ìˆ˜ (0-100)
- **80+**: ìš°ìˆ˜ (ê¸´ ë³¸ë¬¸, ëª…í™•í•œ ì–¸ì–´, ì œëª© í¬í•¨)
- **60-79**: ì–‘í˜¸
- **40-59**: ë³´í†µ (ì§§ì€ ë³¸ë¬¸, í˜¼í•© ì–¸ì–´)
- **<40**: ë¶ˆëŸ‰ (ë§¤ìš° ì§§ì€ ë³¸ë¬¸, ì˜ë¯¸ ì—†ëŠ” í…ìŠ¤íŠ¸)

### í•„í„°ë§
```python
# ê³ í’ˆì§ˆ ë¬¸ì„œë§Œ ê²€ìƒ‰
results = db.search_vector(
    query_embedding=emb,
    min_quality=70
)
```

## ëª¨ë‹ˆí„°ë§

### í†µê³„ í™•ì¸
```python
stats = db.get_stats()
print(f"ì´ ë¬¸ì„œ: {stats['total_docs']}")
print(f"í‰ê·  í’ˆì§ˆ: {stats['avg_quality_score']}")
print(f"ì„¹ì…˜ ë¶„í¬: {stats['section_distribution']}")
print(f"ì–¸ì–´ ë¶„í¬: {stats['language_distribution']}")
```

### ê²€ìƒ‰ ë¡œê·¸ ë¶„ì„
```sql
SELECT 
    query,
    search_type,
    AVG(avg_score) as avg_score,
    COUNT(*) as search_count
FROM search_log
GROUP BY query, search_type
ORDER BY search_count DESC
LIMIT 20;
```

## ë²„ì „ ê´€ë¦¬

### ì„ë² ë”© ëª¨ë¸ ì—…ë°ì´íŠ¸
```sql
-- ìƒˆ ë²„ì „ ì¶”ê°€
INSERT INTO embedding_version (version_number, model_name, dimension, is_active)
VALUES (2, 'intfloat/multilingual-e5-large', 1024, FALSE);

-- ê¸°ì¡´ ë²„ì „ ë¹„í™œì„±í™”
UPDATE embedding_version SET is_active = FALSE WHERE version_number = 1;

-- ìƒˆ ë²„ì „ í™œì„±í™”
UPDATE embedding_version SET is_active = TRUE WHERE version_number = 2;
```

### ì¬ì„ë² ë”©
```python
# íŠ¹ì • ë²„ì „ì˜ ë¬¸ì„œë§Œ ì¬ì„ë² ë”©
old_docs = db.execute_raw(
    "SELECT * FROM lab_docs WHERE emb_ver = 1"
)

for doc in old_docs:
    new_emb = pipeline.embed(doc['text'])
    db.execute_raw(
        "UPDATE lab_docs SET embedding = %s, emb_ver = 2 WHERE doc_id = %s",
        (new_emb.embedding.tolist(), doc['doc_id'])
    )
```

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### 1. pgvector ì„¤ì¹˜ ì˜¤ë¥˜
```bash
# Ubuntu
sudo apt install postgresql-server-dev-14
sudo apt install build-essential

# ì†ŒìŠ¤ ì»´íŒŒì¼
git clone https://github.com/pgvector/pgvector.git
cd pgvector
make
sudo make install
```

### 2. ì„ë² ë”© ëª¨ë¸ ë‹¤ìš´ë¡œë“œ ëŠë¦¼
```python
# ìºì‹œ ë””ë ‰í† ë¦¬ ì§€ì •
import os
os.environ['SENTENCE_TRANSFORMERS_HOME'] = '/path/to/cache'
```

### 3. ë©”ëª¨ë¦¬ ë¶€ì¡±
```python
# ë°°ì¹˜ í¬ê¸° ì¤„ì´ê¸°
results = pipeline.embed(texts, batch_size=8)

# ë˜ëŠ” CPU ì‚¬ìš©
orchestrator = CrawlOrchestrator(device='cpu')
```

## ë¼ì´ì„ ìŠ¤

MIT License

## ê¸°ì—¬

Issuesì™€ Pull Requestsë¥¼ í™˜ì˜í•©ë‹ˆë‹¤!

## ë¬¸ì˜

ë¬¸ì œê°€ ìˆê±°ë‚˜ ì§ˆë¬¸ì´ ìˆìœ¼ì‹œë©´ Issueë¥¼ ì—´ì–´ì£¼ì„¸ìš”.
